# 删除功能400错误修复说明

## 问题描述
用户在商家端秒杀管理页面中，点击"删除"按钮时出现400错误，提示"Request failed with status code 400"，无法删除秒杀活动。

## 问题分析

### 错误原因
这是与启用/停用功能相同的问题：前端API调用与后端接口参数传递方式不匹配。

### 具体问题
1. **删除秒杀活动接口**：
   - **后端期望**：`@RequestParam Long id`（查询参数）
   - **前端发送**：`data: { id: row.id }`（请求体参数）

2. **删除秒杀商品接口**：
   - **后端期望**：`@RequestParam Long id`（查询参数）  
   - **前端发送**：`data: { id: row.id }`（请求体参数）

### 问题影响
- 删除功能完全无法使用
- 用户无法删除不需要的秒杀活动
- 影响秒杀活动的正常管理流程

## 修复方案

### 1. 修复删除秒杀活动API
将参数传递方式从请求体改为查询参数：

```typescript
// 修复前
export const deleteSeckillActivity = (data: any) => {
  return request({
    url: '/admin/seckill/activity',
    method: 'delete',
    data  // 错误：请求体参数
  })
}

// 修复后
export const deleteSeckillActivity = (params: any) => {
  return request({
    url: '/admin/seckill/activity',
    method: 'delete',
    params  // 正确：查询参数
  })
}
```

### 2. 修复删除秒杀商品API
同样将参数传递方式从请求体改为查询参数：

```typescript
// 修复前
export const deleteSeckillGoods = (data: any) => {
  return request({
    url: '/admin/seckill/goods',
    method: 'delete',
    data  // 错误：请求体参数
  })
}

// 修复后
export const deleteSeckillGoods = (params: any) => {
  return request({
    url: '/admin/seckill/goods',
    method: 'delete',
    params  // 正确：查询参数
  })
}
```

### 修复原理
- **DELETE请求通常使用查询参数传递简单的标识符**
- **后端使用`@RequestParam`接收的是查询参数，不是请求体数据**
- **`params`会将数据作为查询参数附加到URL**
- **`data`会将数据放在请求体中**

## 后端接口说明

### 删除秒杀活动接口
```java
@DeleteMapping("/activity")
@ApiOperation("删除秒杀活动")
public Result<String> delete(@RequestParam Long id) {
    log.info("删除秒杀活动：{}", id);
    seckillActivityService.deleteById(id);
    return Result.success();
}
```

### 删除秒杀商品接口
```java
@DeleteMapping("/goods")
@ApiOperation("删除秒杀商品")
public Result<String> deleteGoods(@RequestParam Long id) {
    log.info("删除秒杀商品：{}", id);
    seckillGoodsService.deleteById(id);
    return Result.success();
}
```

## 修复验证

### 修复前
```
DELETE /admin/seckill/activity
Content-Type: application/json
Body: {"id": 1}
```
后端无法从查询参数中获取`id`，导致400错误

### 修复后
```
DELETE /admin/seckill/activity?id=1
```
后端可以正确从查询参数中获取`id`参数

## 相关修复总结

到目前为止，我们修复了三个相同类型的API参数传递问题：

1. **启用/停用秒杀活动**: `POST /admin/seckill/activity/status/{status}?id=1`
2. **删除秒杀活动**: `DELETE /admin/seckill/activity?id=1`  
3. **删除秒杀商品**: `DELETE /admin/seckill/goods?id=1`

这些接口都使用`@RequestParam`接收参数，需要通过查询参数传递，而不是请求体。

## 测试建议

1. **删除测试**：
   - 对未开始的活动点击"删除"按钮
   - 验证活动是否成功删除
   - 验证页面是否正确刷新

2. **权限测试**：
   - 验证只有未开始的活动可以删除
   - 验证进行中/已结束的活动删除按钮被正确禁用

3. **确认对话框测试**：
   - 验证删除确认对话框是否正常显示
   - 验证取消删除操作是否正常

## 总结

通过将删除相关API的参数传递方式从`data`改为`params`，成功解决了删除功能的400错误问题。现在用户可以正常删除未开始的秒杀活动，完善了秒杀管理功能的完整性。

这个修复延续了之前启用/停用功能的修复模式，确保了API调用方式与后端接口设计的一致性。

